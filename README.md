# é‡åŒ–äº¤æ˜“ç³»ç»Ÿ

ä¸€ä¸ªç”Ÿäº§çº§çš„ Java é‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œä¸“æ³¨äº USDT æœ¬ä½åˆçº¦äº¤æ˜“ã€‚

**æ ¸å¿ƒç†å¿µï¼šèµšé’±ä¼˜å…ˆ Â· é£æ§ç¬¬ä¸€ Â· ç¨³å®šè¿è¡Œ**

## ç‰¹æ€§

- âœ… **ä¸¥æ ¼é£æ§** - æ¯ç¬”äº¤æ˜“é£é™© 1-2%ï¼Œå¼ºåˆ¶æ­¢æŸï¼Œæœ€å¤§å›æ’¤ <30%
- âœ… **å®Œæ•´æ¶æ„** - è¡Œæƒ…é‡‡é›† â†’ ç­–ç•¥å¼•æ“ â†’ é£æ§æ¨¡å— â†’ è®¢å•æ‰§è¡Œ â†’ äº¤æ˜“æ‰€
- âœ… **å›æµ‹å¼•æ“** - æ”¯æŒæ‰‹ç»­è´¹ã€æ»‘ç‚¹æ¨¡æ‹Ÿï¼Œè¾“å‡ºå®Œæ•´å›æµ‹æŠ¥å‘Š
- âœ… **å¤šäº¤æ˜“æ‰€** - æŠ½è±¡æ¥å£è®¾è®¡ï¼Œå·²å®ç° Binanceï¼ŒOKX å¯æ‰©å±•
- âœ… **æŠ€æœ¯æŒ‡æ ‡** - SMAã€EMAã€RSIã€MACDã€BOLLã€ATR ç­‰å¸¸ç”¨æŒ‡æ ‡
- âœ… **ç­–ç•¥æ¡†æ¶** - æä¾›æŠ½è±¡åŸºç±»ï¼Œå¿«é€Ÿå¼€å‘è‡ªå®šä¹‰ç­–ç•¥
- âœ… **æ•°æ®æŒä¹…åŒ–** - è®¢å•æŒä¹…åŒ–ï¼Œæ”¯æŒå´©æºƒæ¢å¤
- âœ… **å®æ—¶ç›‘æ§** - WebSocket è¡Œæƒ…è®¢é˜…ï¼Œè‡ªåŠ¨æ–­çº¿é‡è¿

## ç³»ç»Ÿçº¦æŸ

| çº¦æŸé¡¹ | è¯´æ˜ |
|--------|------|
| äº¤æ˜“å¸‚åœº | ä»…æ”¯æŒä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ USDT æœ¬ä½åˆçº¦ |
| äº¤æ˜“å‘¨æœŸ | ä»…æ”¯æŒ 1mã€5m Kçº¿ï¼ˆç¦æ­¢é«˜é¢‘ï¼‰ |
| é£é™©æ§åˆ¶ | ç¦æ­¢é©¬ä¸ã€ç¦æ­¢å…¨ä»“ |
| æ¯ç¬”é£é™© | â‰¤ 1-2% è´¦æˆ·èµ„é‡‘ |
| æ­¢æŸè¦æ±‚ | å¿…é¡»è®¾ç½®æ­¢æŸï¼ˆATR æˆ–å›ºå®šï¼‰ |
| æœ€å¤§å›æ’¤ | å•ç­–ç•¥ < 30% |

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MarketData  â”‚â”€â”€â”€â–¶â”‚  Strategy   â”‚â”€â”€â”€â–¶â”‚   Risk      â”‚â”€â”€â”€â–¶â”‚   Order     â”‚
â”‚   è¡Œæƒ…æ¨¡å—   â”‚    â”‚   Engine    â”‚    â”‚  Control    â”‚    â”‚  Executor   â”‚
â”‚             â”‚    â”‚   ç­–ç•¥å¼•æ“   â”‚    â”‚   é£æ§æ¨¡å—   â”‚    â”‚   æ‰§è¡Œæ¨¡å—   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                           â”‚
                                                           â–¼
                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                    â”‚  Exchange   â”‚
                                                    â”‚   äº¤æ˜“æ‰€    â”‚
                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒåŸåˆ™ï¼š**
- **StrategyEngine** åªäº§å‡ºäº¤æ˜“æ„å›¾ï¼ˆSignalï¼‰ï¼Œä¸æ‰§è¡Œäº¤æ˜“
- **RiskControl** æ‹¥æœ‰æœ€ç»ˆå¦å†³æƒ
- **Exchange** å±‚åªè´Ÿè´£æ‰§è¡Œï¼Œä¸åŒ…å«ä¸šåŠ¡é€»è¾‘

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Java 17+
- Maven 3.x

### ç¼–è¯‘é¡¹ç›®

```bash
mvn compile
```

### æ‰“åŒ…

```bash
mvn package
```

### è¿è¡Œå›æµ‹

```bash
java -cp target/classes com.trade.quant.TradingSystemMain backtest
```

### è¿è¡Œå®ç›˜ï¼ˆéœ€é…ç½® API å¯†é’¥ï¼‰

```bash
export BINANCE_API_KEY="your_api_key"
export BINANCE_SECRET_KEY="your_secret_key"

java -cp target/classes com.trade.quant.TradingSystemMain live
```

## é¡¹ç›®ç»“æ„

```
src/main/java/com/trade/quant/
â”œâ”€â”€ core/                  # æ ¸å¿ƒé¢†åŸŸæ¨¡å‹
â”‚   â”œâ”€â”€ Symbol.java       # äº¤æ˜“å¯¹
â”‚   â”œâ”€â”€ Order.java        # è®¢å•
â”‚   â”œâ”€â”€ Position.java     # æŒä»“
â”‚   â”œâ”€â”€ KLine.java        # Kçº¿æ•°æ®
â”‚   â””â”€â”€ Decimal.java      # BigDecimal å·¥å…·ç±»
â”œâ”€â”€ exchange/             # äº¤æ˜“æ‰€æŠ½è±¡å±‚
â”‚   â”œâ”€â”€ Exchange.java             # äº¤æ˜“æ‰€æ¥å£
â”‚   â”œâ”€â”€ BinanceExchange.java      # Binance å®ç°
â”‚   â””â”€â”€ ExchangeFactory.java      # å·¥å‚ç±»
â”œâ”€â”€ market/               # è¡Œæƒ…æ•°æ®æ¨¡å—
â”‚   â”œâ”€â”€ MarketDataManager.java   # è¡Œæƒ…ç®¡ç†å™¨
â”‚   â””â”€â”€ MarketDataListener.java  # ç›‘å¬å™¨æ¥å£
â”œâ”€â”€ indicator/            # æŠ€æœ¯æŒ‡æ ‡
â”‚   â”œâ”€â”€ SMA.java, EMA.java        # ç§»åŠ¨å¹³å‡çº¿
â”‚   â”œâ”€â”€ RSI.java                  # ç›¸å¯¹å¼ºå¼±æŒ‡æ ‡
â”‚   â”œâ”€â”€ MACD.java                 # å¹³æ»‘å¼‚åŒç§»åŠ¨å¹³å‡
â”‚   â”œâ”€â”€ BOLL.java                 # å¸ƒæ—å¸¦
â”‚   â””â”€â”€ ATR.java                  # å¹³å‡çœŸå®æ³¢å¹…
â”œâ”€â”€ strategy/             # ç­–ç•¥å¼•æ“
â”‚   â”œâ”€â”€ Strategy.java             # ç­–ç•¥æ¥å£
â”‚   â”œâ”€â”€ AbstractStrategy.java     # ç­–ç•¥åŸºç±»
â”‚   â”œâ”€â”€ StrategyEngine.java       # ç­–ç•¥å¼•æ“
â”‚   â”œâ”€â”€ Signal.java               # äº¤æ˜“ä¿¡å·
â”‚   â””â”€â”€ impl/
â”‚       â””â”€â”€ DualMovingAverageStrategy.java  # åŒå‡çº¿ç­–ç•¥ç¤ºä¾‹
â”œâ”€â”€ risk/                 # é£æ§æ¨¡å—
â”‚   â”œâ”€â”€ RiskControl.java          # é£æ§æ ¸å¿ƒ
â”‚   â”œâ”€â”€ RiskConfig.java           # é£æ§é…ç½®
â”‚   â””â”€â”€ StopLossManager.java      # æ­¢æŸç®¡ç†å™¨
â”œâ”€â”€ backtest/             # å›æµ‹å¼•æ“
â”‚   â”œâ”€â”€ BacktestEngine.java       # å›æµ‹å¼•æ“
â”‚   â”œâ”€â”€ BacktestConfig.java       # å›æµ‹é…ç½®
â”‚   â””â”€â”€ BacktestResult.java       # å›æµ‹ç»“æœ
â””â”€â”€ execution/            # å®ç›˜æ‰§è¡Œ
    â”œâ”€â”€ TradingEngine.java        # äº¤æ˜“å¼•æ“
    â”œâ”€â”€ OrderExecutor.java        # è®¢å•æ‰§è¡Œå™¨
    â””â”€â”€ FilePersistence.java      # æ–‡ä»¶æŒä¹…åŒ–
```

## å¼€å‘æŒ‡å—

### åˆ›å»ºè‡ªå®šä¹‰ç­–ç•¥

ç»§æ‰¿ `AbstractStrategy` å¹¶å®ç° `analyze()` æ–¹æ³•ï¼š

```java
package com.trade.quant.strategy.impl;

import com.trade.quant.strategy.AbstractStrategy;
import com.trade.quant.core.*;
import com.trade.quant.strategy.*;
import com.trade.quant.indicator.SMA;

import java.math.BigDecimal;
import java.util.List;

public class MyStrategy extends AbstractStrategy {

    public MyStrategy(Symbol symbol, Interval interval, StrategyConfig config) {
        super("MyStrategy", symbol, interval, config);
    }

    @Override
    public String getName() {
        return "æˆ‘çš„ç­–ç•¥";
    }

    @Override
    public Signal analyze(List<KLine> kLines) {
        // 1. æ£€æŸ¥å†·å´æœŸ
        if (isInCooldown()) return null;

        // 2. æŠ€æœ¯åˆ†æ
        List<BigDecimal> closes = extractCloses(kLines);
        SMA sma = new SMA(20);
        BigDecimal currentSMA = sma.latest(closes);
        BigDecimal currentPrice = getLatestPrice(kLines);

        // 3. ç”Ÿæˆä¿¡å·
        if (currentPrice.compareTo(currentSMA) > 0) {
            // é‡‘å‰å…¥åœº
            recordTrade();
            return createLongSignal(kLines, BigDecimal.valueOf(0.01), "ä»·æ ¼çªç ´å‡çº¿");
        }

        return null;
    }

    @Override
    public Signal onPositionUpdate(Position position, KLine currentKLine) {
        // æŒä»“æ—¶çš„å‡ºåœºé€»è¾‘
        return null;
    }
}
```

### ä½¿ç”¨ç­–ç•¥

```java
// åˆ›å»ºç­–ç•¥
StrategyConfig config = StrategyConfig.builder()
    .riskPerTrade(BigDecimal.valueOf(0.01))  // æ¯ç¬”é£é™© 1%
    .cooldownBars(3)                          // å†·å´ 3 æ ¹ Kçº¿
    .useATRStopLoss(true)                     // ä½¿ç”¨ ATR æ­¢æŸ
    .build();

MyStrategy strategy = new MyStrategy(
    Symbol.of("BTC-USDT"),
    Interval.FIVE_MINUTES,
    config
);

// æ·»åŠ åˆ°ç­–ç•¥å¼•æ“
StrategyEngine engine = new StrategyEngine(marketDataManager);
engine.addStrategy(strategy);
engine.start();
```

### é£æ§é…ç½®

```java
RiskConfig riskConfig = RiskConfig.builder()
    .riskPerTrade(BigDecimal.valueOf(0.01))           // æ¯ç¬”é£é™© 1%
    .maxPositionRatio(BigDecimal.valueOf(0.1))        // æœ€å¤§ä»“ä½ 10%
    .maxStopLossPercent(BigDecimal.valueOf(5))        // æœ€å¤§æ­¢æŸ 5%
    .maxConsecutiveLosses(3)                          // æœ€å¤§è¿ç»­äºæŸ 3 æ¬¡
    .maxDrawdownPercent(BigDecimal.valueOf(30))       // æœ€å¤§å›æ’¤ 30%
    .build();

RiskControl riskControl = new RiskControl(riskConfig, accountInfo);
```

## å›æµ‹ç¤ºä¾‹

```java
// é…ç½®å›æµ‹å‚æ•°
BacktestConfig config = BacktestConfig.builder()
    .symbol(Symbol.of("BTC-USDT"))
    .interval(Interval.FIVE_MINUTES)
    .startTime(Instant.parse("2024-01-01T00:00:00Z"))
    .endTime(Instant.parse("2024-12-01T00:00:00Z"))
    .initialCapital(BigDecimal.valueOf(10000))
    .makerFee(BigDecimal.valueOf(0.0002))
    .takerFee(BigDecimal.valueOf(0.0004))
    .slippage(BigDecimal.valueOf(0.0005))
    .build();

// è¿è¡Œå›æµ‹
BacktestEngine engine = new BacktestEngine(config, exchange, strategy);
BacktestResult result = engine.run();

// è¾“å‡ºç»“æœ
System.out.println(result);
```

**å›æµ‹è¾“å‡ºæŒ‡æ ‡ï¼š**
- æ€»æ”¶ç›Šç‡ã€å¹´åŒ–æ”¶ç›Šç‡
- æœ€å¤§å›æ’¤
- å¤æ™®æ¯”ç‡
- èƒœç‡ã€ç›ˆäºæ¯”
- å¹³å‡ç›ˆåˆ©/äºæŸ
- èµ„é‡‘æ›²çº¿

## é‡è¦æç¤º

### âš ï¸ å®ç›˜äº¤æ˜“å‰å¿…è¯»

1. **å……åˆ†å›æµ‹** - åœ¨æ¨¡æ‹Ÿç¯å¢ƒå……åˆ†éªŒè¯ç­–ç•¥
2. **å°èµ„é‡‘æµ‹è¯•** - å…ˆç”¨å°èµ„é‡‘å®ç›˜æµ‹è¯•
3. **ç›‘æ§æ—¥å¿—** - å®æ—¶ç›‘æ§ `logs/trading.log`
4. **è®¾ç½®é£æ§** - ä¸¥æ ¼é…ç½®æœ€å¤§å›æ’¤å’Œè¿ç»­äºæŸé™åˆ¶
5. **å®šæœŸæ£€æŸ¥** - å®šæœŸæ£€æŸ¥æŒä»“å’Œè®¢å•çŠ¶æ€

### ğŸš« ç¦æ­¢äº‹é¡¹

- âŒ ç¦æ­¢åœ¨ç­–ç•¥å±‚ç›´æ¥è°ƒç”¨äº¤æ˜“æ‰€ SDK
- âŒ ç¦æ­¢åœ¨å®ç›˜ä¸­ä½¿ç”¨æœªå……åˆ†å›æµ‹çš„ç­–ç•¥
- âŒ ç¦æ­¢ä¿®æ”¹é£æ§é™åˆ¶ä»¥è§„é¿æ£€æŸ¥
- âŒ ç¦æ­¢åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨è°ƒè¯•æ—¥å¿—

### ğŸ’¡ æœ€ä½³å®è·µ

- âœ… æ‰€æœ‰é‡‘é¢è®¡ç®—ä½¿ç”¨ `BigDecimal`
- âœ… æ—¶é—´ç»Ÿä¸€ä½¿ç”¨ UTC æ—¶åŒº
- âœ… è®¢å•å¿…é¡»è®¾ç½®æ­¢æŸä»·æ ¼
- âœ… ä½¿ç”¨æŠ½è±¡ç±»è€Œéç›´æ¥å®ç°æ¥å£
- âœ… ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–æ ¸å¿ƒé€»è¾‘

## å¾…åŠäº‹é¡¹

- [ ] å®Œå–„ BinanceExchange ä¸‹å•åŠŸèƒ½
- [ ] å®ç° OKX äº¤æ˜“æ‰€
- [ ] æ·»åŠ æ›´å¤šç¤ºä¾‹ç­–ç•¥ï¼ˆçªç ´ã€å›æ’¤å…¥åœºç­‰ï¼‰
- [ ] å¢åŠ å•å…ƒæµ‹è¯•è¦†ç›–ç‡
- [ ] ä¼˜åŒ– WebSocket æ–­çº¿é‡è¿æœºåˆ¶
- [ ] æ·»åŠ ç­–ç•¥å‚æ•°ä¼˜åŒ–å™¨
- [ ] å®ç°ç»„åˆçº§é£æ§

## æŠ€æœ¯æ ˆ

- **Java 17** - æ ¸å¿ƒè¯­è¨€
- **Maven** - é¡¹ç›®ç®¡ç†
- **OkHttp 4.12** - HTTP å®¢æˆ·ç«¯
- **Jackson 2.16** - JSON å¤„ç†
- **SLF4J + Logback** - æ—¥å¿—æ¡†æ¶
- **JUnit 5** - å•å…ƒæµ‹è¯•

